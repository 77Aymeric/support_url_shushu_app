const translations = {
    en: {
        pageTitle: "ShuShu - Learn to count in Chinese",
        metaDescription: "Support, documentation, and FAQ for the ShuShu app.",
        nav: {
            features: "Features",
            documentation: "Documentation",
            faq: "FAQ",
            contact: "Contact"
        },
        hero: {
            title: "Learn Chinese <br><span>by counting</span>",
            description: "Master Chinese numbers from 0 to 99,999 with ShuShu. A fun, progressive, and incredibly addictive method.",
            ctaCourses: "Discover Courses",
            ctaMore: "Learn More →"
        },
        doc: {
            title: "Documentation & Game Modes",
            subtitle: "Everything you need to know to progress in ShuShu.",
            cards: {
                training: {
                    badge: "Training",
                    title: "Reading & Construction",
                    text: "In <strong>Reading</strong> mode, translate Hanzi to Arabic numerals. In <strong>Construction</strong> mode, do the reverse to assimilate number structure."
                },
                audio: {
                    badge: "Audio",
                    title: "Listening & Dictation",
                    text: "Improve your ear with <strong>Listening</strong> mode. Dare to speak with <strong>Dictation</strong> mode using voice recognition to validate your pronunciation."
                },
                arcade: {
                    badge: "Arcade",
                    title: "Timer & Survival",
                    text: "Challenge yourself! <strong>Timer</strong> mode gives you 60s to score max points. <strong>Survival</strong> mode forgives no errors (3 lives)."
                },
                courses: {
                    title: "Progressive Courses",
                    text: "Structured chapters to learn basics, tens, hundreds, thousands, and the famous Wan (10,000). Each rule explained with audio examples."
                },
                progress: {
                    title: "Progress Tracking",
                    text: "Analyze your accuracy, global score, and identify 'weak points' to launch targeted training sessions."
                },
                streak: {
                    title: "Streak & Consistency",
                    text: "Keep your streak alive by practicing daily. Set your daily goal and unlock outfits for your Panda."
                }
            }
        },
        faq: {
            title: "Frequently Asked Questions",
            subtitle: "Clear answers to help you.",
            q1: "Is the app free?",
            a1: "Yes, the app is entirely free for now. Enjoy all game modes without limits!",
            q2: "Who is ShuShu for?",
            a2: "ShuShu is ideal for beginners and intermediate levels wishing to automate reading and understanding Chinese numbers, a fundamental skill often overlooked.",
            q3: "I have a problem with voice recognition.",
            a3: "Ensure you are in a quiet environment and have granted microphone access. Quality also depends on your phone's speech engine.",
            q4: "Can I use the app offline?",
            a4: "Yes, most features (Reading, Construction, Courses) are accessible without an internet connection.",
            q5: "How do I save my progress?",
            a5: "Your progress is saved locally on your device. We do not collect personal data without your explicit consent."
        },
        contact: {
            title: "Can't find your answer?",
            text: "Our team is here to help you personally.",
            button: "Contact Us"
        },
        footer: "&copy; 2026 ShuShu. Made with ❤️ for learning Chinese."
    },
    fr: {
        pageTitle: "ShuShu - Apprenez à compter en chinois",
        metaDescription: "Support, documentation et FAQ pour l'application ShuShu.",
        nav: {
            features: "Fonctionnalités",
            documentation: "Documentation",
            faq: "FAQ",
            contact: "Contact"
        },
        hero: {
            title: "Apprenez le chinois <br><span>en comptant</span>",
            description: "Maîtrisez les nombres en chinois de 0 à 99 999 avec ShuShu. Une méthode ludique, progressive et incroyablement addictive.",
            ctaCourses: "Découvrir les cours",
            ctaMore: "En savoir plus →"
        },
        doc: {
            title: "Documentation & Modes de Jeu",
            subtitle: "Tout ce que vous devez savoir pour progresser dans ShuShu.",
            cards: {
                training: {
                    badge: "Entraînement",
                    title: "Lecture & Construction",
                    text: "En mode <strong>Lecture</strong>, traduisez les Hanzi en chiffres arabes. En mode <strong>Construction</strong>, faites l'inverse pour assimiler la structure des nombres."
                },
                audio: {
                    badge: "Audio",
                    title: "Écoute & Dictée",
                    text: "Améliorez votre oreille avec le mode <strong>Écoute</strong>. Osez parler avec le mode <strong>Dictée</strong> qui utilise la reconnaissance vocale pour valider votre prononciation."
                },
                arcade: {
                    badge: "Arcade",
                    title: "Timer & Survie",
                    text: "Challengez-vous ! Le mode <strong>Timer</strong> vous donne 60s pour faire un max de points. Le mode <strong>Survie</strong> ne pardonne aucune erreur (3 vies)."
                },
                courses: {
                    title: "Cours Progressifs",
                    text: "Des chapitres structurés pour apprendre les bases, les dizaines, centaines, milliers et le fameux Wan (10 000). Chaque règle est expliquée avec des exemples audio."
                },
                progress: {
                    title: "Suivi de Progression",
                    text: "Analysez votre précision, votre score global et identifiez vos 'points faibles' pour lancer des sessions d'entraînement ciblées."
                },
                streak: {
                    title: "Streak & Régularité",
                    text: "Maintenez votre flamme en pratiquant tous les jours. Fixez votre objectif quotidien et débloquez des tenues pour votre Panda."
                }
            }
        },
        faq: {
            title: "Questions Fréquentes",
            subtitle: "Des réponses claires pour vous aider.",
            q1: "L'application est-elle gratuite ?",
            a1: "Oui, l'application est entièrement gratuite pour le moment. Profitez de tous les modes de jeu sans limite !",
            q2: "À qui s'adresse ShuShu ?",
            a2: "ShuShu est idéale pour les débutants et niveaux intermédiaires qui souhaitent automatiser leur lecture et compréhension des nombres chinois, une compétence fondamentale souvent négligée.",
            q3: "J'ai un problème avec la reconnaissance vocale.",
            a3: "Assurez-vous d'être dans un environnement calme et d'avoir autorisé l'accès au micro. La qualité dépend aussi du moteur vocal de votre téléphone.",
            q4: "Puis-je utiliser l'application hors ligne ?",
            a4: "Oui, la majorité des fonctionnalités (Lecture, Construction, Cours) sont accessibles sans connexion internet.",
            q5: "Comment sauvegarder ma progression ?",
            a5: "Votre progression est sauvegardée localement sur votre appareil. Nous ne collectons pas vos données personnelles sans votre consentement explicite."
        },
        contact: {
            title: "Vous ne trouvez pas votre réponse ?",
            text: "Notre équipe est là pour vous aider personnellement.",
            button: "Nous Contacter"
        },
        footer: "&copy; 2026 ShuShu. Fait avec ❤️ pour l'apprentissage du chinois."
    },
    es: {
        pageTitle: "ShuShu - Aprende a contar en chino",
        metaDescription: "Soporte, documentación y preguntas frecuentes para la aplicación ShuShu.",
        nav: {
            features: "Funcionalidades",
            documentation: "Documentación",
            faq: "Preguntas Frecuentes",
            contact: "Contacto"
        },
        hero: {
            title: "Aprende chino <br><span>contando</span>",
            description: "Domina los números chinos del 0 al 99 999 con ShuShu. Un método divertido, progresivo e increíblemente adictivo.",
            ctaCourses: "Descubrir los cursos",
            ctaMore: "Saber más →"
        },
        doc: {
            title: "Documentación y Modos de Juego",
            subtitle: "Todo lo que necesitas saber para progresar en ShuShu.",
            cards: {
                training: {
                    badge: "Entrenamiento",
                    title: "Lectura y Construcción",
                    text: "En modo <strong>Lectura</strong>, traduce los Hanzi a números arábigos. En modo <strong>Construcción</strong>, haz lo contrario para asimilar la estructura de los números."
                },
                audio: {
                    badge: "Audio",
                    title: "Escucha y Dictado",
                    text: "Mejora tu oído con el modo <strong>Escucha</strong>. Atrévete a hablar con el modo <strong>Dictado</strong> que utiliza el reconocimiento de voz para validar tu pronunciación."
                },
                arcade: {
                    badge: "Arcade",
                    title: "Temporizador y Supervivencia",
                    text: "¡Desafíate! El modo <strong>Temporizador</strong> te da 60s para hacer el máximo de puntos. El modo <strong>Supervivencia</strong> no perdona ningún error (3 vidas)."
                },
                courses: {
                    title: "Cursos Progresivos",
                    text: "Capítulos estructurados para aprender las bases, decenas, centenas, millares y el famoso Wan (10 000). Cada regla se explica con ejemplos de audio."
                },
                progress: {
                    title: "Seguimiento del Progreso",
                    text: "Analiza tu precisión, tu puntuación global e identifica tus 'puntos débiles' para lanzar sesiones de entrenamiento específicas."
                },
                streak: {
                    title: "Racha y Regularidad",
                    text: "Mantén tu racha practicando todos los días. Fija tu objetivo diario y desbloquea atuendos para tu Panda."
                }
            }
        },
        faq: {
            title: "Preguntas Frecuentes",
            subtitle: "Respuestas claras para ayudarte.",
            q1: "¿La aplicación es gratuita?",
            a1: "Sí, la aplicación es totalmente gratuita por el momento. ¡Disfruta de todos los modos de juego sin límite!",
            q2: "¿Para quién es ShuShu?",
            a2: "ShuShu es ideal para principiantes y niveles intermedios que desean automatizar su lectura y comprensión de los números chinos, una habilidad fundamental a menudo descuidada.",
            q3: "Tengo un problema con el reconocimiento de voz.",
            a3: "Asegúrate de estar en un ambiente tranquilo y de haber autorizado el acceso al micrófono. La calidad también depende del motor de voz de tu teléfono.",
            q4: "¿Puedo usar la aplicación sin conexión?",
            a4: "Sí, la mayoría de las funcionalidades (Lectura, Construcción, Cursos) son accesibles sin conexión a internet.",
            q5: "¿Cómo guardar mi progreso?",
            a5: "Tu progreso se guarda localmente en tu dispositivo. No recopilamos tus datos personales sin tu consentimiento explicito."
        },
        contact: {
            title: "¿No encuentras tu respuesta?",
            text: "Nuestro equipo está aquí para ayudarte personalmente.",
            button: "Contáctanos"
        },
        footer: "&copy; 2026 ShuShu. Hecho con ❤️ para aprender chino."
    }
};

function updateContent(lang) {
    if (!translations[lang]) lang = 'en'; // Fallback to English

    // Update Text Content
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const keys = key.split('.');
        let text = translations[lang];
        
        for (const k of keys) {
            if (text[k]) {
                text = text[k];
            } else {
                text = null;
                break;
            }
        }

        if (text) {
            // Handle HTML content if detected (simple check for <)
            if (typeof text === 'string' && text.includes('<')) {
                element.innerHTML = text;
            } else {
                element.textContent = text;
            }
        }
    });

    // Update Document Title and Meta Description
    document.title = translations[lang].pageTitle;
    const metaDesc = document.querySelector('meta[name="description"]');
    if (metaDesc) {
        metaDesc.setAttribute('content', translations[lang].metaDescription);
    }

    // Update Language Selectors UI
    updateLanguageSelector(lang);
}

function updateLanguageSelector(currentLang) {
    // You can implement custom UI updates here, like highlighting the active flag/option
    // For now, we update the select element if it exists
    const select = document.getElementById('language-select');
    if (select) {
        select.value = currentLang;
    }
}

function setLanguage(lang) {
    localStorage.setItem('shushu_language', lang);
    updateContent(lang);
    document.documentElement.lang = lang;
}

function initLanguage() {
    // Check localStorage OR detect browser language
    const savedLang = localStorage.getItem('shushu_language');
    if (savedLang && translations[savedLang]) {
        setLanguage(savedLang);
        return;
    }

    const browserLang = navigator.language.slice(0, 2);
    if (translations[browserLang]) {
        setLanguage(browserLang);
    } else {
        setLanguage('en'); // Default
    }
}

// Initialize on load
document.addEventListener('DOMContentLoaded', () => {
    initLanguage();

    // Attach event listener to language selector
    const selector = document.getElementById('language-selector');
    if (selector) {
        selector.addEventListener('change', (e) => {
            setLanguage(e.target.value);
        });
    }
});
